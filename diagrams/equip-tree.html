<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xeto Inheritance Tree</title>
    <style>
        :root {
            --color-core: #e0e0e0;
            --color-upstream: #ff6b6b;
            --color-hpbs: #ffa500;
            --bg-color: #1e1e1e;
            --text-color: #d4d4d4;
            --tree-line-color: #555;
        }

        body {
            font-family: 'SF Mono', 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            line-height: 1.5;
            background-color: var(--bg-color);
            color: var(--text-color);
            padding: 20px;
            margin: 0;
        }

        h1 {
            color: #fff;
            margin-bottom: 10px;
        }

        .legend {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            padding: 10px;
            background: #2d2d2d;
            border-radius: 6px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-swatch {
            width: 16px;
            height: 16px;
            border-radius: 3px;
            border: 1px solid #555;
        }

        .legend-swatch.core { background-color: var(--color-core); }
        .legend-swatch.upstream { background-color: var(--color-upstream); }
        .legend-swatch.hpbs { background-color: var(--color-hpbs); }

        .stats {
            color: #888;
            font-size: 12px;
        }

        .tree {
            margin: 0;
            padding: 0;
        }

        .tree ul {
            margin: 0;
            padding-left: 20px;
            list-style: none;
            border-left: 1px solid var(--tree-line-color);
        }

        .tree > ul {
            border-left: none;
            padding-left: 0;
        }

        .tree li {
            margin: 2px 0;
            padding-left: 15px;
            position: relative;
        }

        .tree li::before {
            content: "";
            position: absolute;
            left: -1px;
            top: 0.7em;
            width: 12px;
            height: 1px;
            background: var(--tree-line-color);
        }

        .tree > li::before {
            display: none;
        }

        .spec-name {
            font-weight: 600;
            padding: 1px 4px;
            border-radius: 3px;
        }

        .spec-name.cat-core {
            color: var(--color-core);
        }

        .spec-name.cat-upstream {
            color: var(--color-upstream);
        }

        .spec-name.cat-hpbs {
            color: var(--color-hpbs);
        }

        .library {
            color: #888;
            font-size: 11px;
        }

        .abstract {
            color: #6a9fb5;
            font-size: 11px;
            font-style: italic;
        }

        .mixins {
            color: #b294bb;
            font-size: 11px;
        }

        /* Collapsible tree */
        .tree li > ul {
            display: block;
        }

        .tree li.collapsed > ul {
            display: none;
        }

        .tree li.has-children > .spec-name::before {
            content: "▼ ";
            font-size: 10px;
            color: #666;
            cursor: pointer;
        }

        .tree li.has-children.collapsed > .spec-name::before {
            content: "▶ ";
        }

        /* Filter controls */
        .controls {
            margin-bottom: 15px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .controls label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }

        .controls input[type="checkbox"] {
            cursor: pointer;
        }

        .search-box {
            padding: 5px 10px;
            border: 1px solid #444;
            border-radius: 4px;
            background: #2d2d2d;
            color: #d4d4d4;
            font-family: inherit;
        }

        .search-box:focus {
            outline: none;
            border-color: #666;
        }

        .highlight {
            background-color: #4a4a00;
        }
    </style>
</head>
<body>
    <h1>Xeto Inheritance Tree</h1>

    <div class="legend">
        <div class="legend-item">
            <div class="legend-swatch core"></div>
            <span>Core (xeto repo)</span>
            <span class="stats">(851)</span>
        </div>
        <div class="legend-item">
            <div class="legend-swatch upstream"></div>
            <span>Upstream candidates (ph.* files)</span>
            <span class="stats">(123)</span>
        </div>
        <div class="legend-item">
            <div class="legend-swatch hpbs"></div>
            <span>HPBS standalone</span>
            <span class="stats">(452)</span>
        </div>
    </div>

    <div class="controls">
        <input type="text" class="search-box" placeholder="Search specs..." id="search">
        <label><input type="checkbox" id="show-core" checked> Show core</label>
        <label><input type="checkbox" id="show-upstream" checked> Show upstream</label>
        <label><input type="checkbox" id="show-hpbs" checked> Show HPBS</label>
        <button onclick="expandAll()">Expand All</button>
        <button onclick="collapseAll()">Collapse All</button>
    </div>

    <div class="tree">
        <ul>
            <li>
  <span class="spec-name cat-core">Equip</span> <span class="library">(ph)</span> <span class="abstract">[abstract]</span>
  <ul>
    <li>
  <span class="spec-name cat-core">Actuator</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-core">DamperActuator</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-core">ValveActuator</span> <span class="library">(ph)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-core">AirHandlingEquip</span> <span class="library">(ph)</span> <span class="abstract">[abstract]</span>
  <ul>
    <li>
  <span class="spec-name cat-core">Ahu</span> <span class="library">(ph)</span>
  <ul>
    <li>
  <span class="spec-name cat-core">Doas</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsDoas</span> <span class="library">(hpbs)</span></li>
<li>
  <span class="spec-name cat-core">Mau</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsMau</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
  </ul>
</li>
<li><span class="spec-name cat-hpbs">HpbsAhu</span> <span class="library">(hpbs)</span></li>
<li><span class="spec-name cat-hpbs">HpbsAhuWithEconomizer</span> <span class="library">(hpbs)</span></li>
<li>
  <span class="spec-name cat-core">Rtu</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsRtu</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li><span class="spec-name cat-core">VavZoneAhu</span> <span class="library">(ph.equips)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-core">Fcu</span> <span class="library">(ph)</span>
  <ul>
    <li>
  <span class="spec-name cat-core">Crac</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsCrac</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li><span class="spec-name cat-hpbs">HpbsFcu</span> <span class="library">(hpbs)</span></li>
<li><span class="spec-name cat-hpbs">HpbsFcu2Pipe</span> <span class="library">(hpbs)</span></li>
<li><span class="spec-name cat-hpbs">HpbsFcu4Pipe</span> <span class="library">(hpbs)</span></li>
<li><span class="spec-name cat-core">UnitVent</span> <span class="library">(ph)</span></li>
  </ul>
</li>
  </ul>
</li>
<li>
  <span class="spec-name cat-core">AirTerminalUnit</span> <span class="library">(ph)</span> <span class="abstract">[abstract]</span>
  <ul>
    <li><span class="spec-name cat-core">Cav</span> <span class="library">(ph)</span></li>
<li>
  <span class="spec-name cat-core">Vav</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-core">AhuVav</span> <span class="library">(ph.equips)</span></li>
<li>
  <span class="spec-name cat-upstream">FanPoweredVav</span> <span class="library">(hpbs)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsFanPoweredVav</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li><span class="spec-name cat-hpbs">HpbsVav</span> <span class="library">(hpbs)</span></li>
<li><span class="spec-name cat-hpbs">HpbsVavElecReheat</span> <span class="library">(hpbs)</span></li>
<li><span class="spec-name cat-hpbs">HpbsVavReheat</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
  </ul>
</li>
<li><span class="spec-name cat-core">Ates</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-core">Battery</span> <span class="library">(ph)</span></li>
<li>
  <span class="spec-name cat-core">Boiler</span> <span class="library">(ph)</span>
  <ul>
    <li>
  <span class="spec-name cat-core">HotWaterBoiler</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsHotWaterBoiler</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li><span class="spec-name cat-hpbs">HpbsBoiler</span> <span class="library">(hpbs)</span></li>
<li><span class="spec-name cat-hpbs">HpbsCondensingBoiler</span> <span class="library">(hpbs)</span></li>
<li>
  <span class="spec-name cat-core">SteamBoiler</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsSteamBoiler</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
  </ul>
</li>
<li><span class="spec-name cat-core">Cable</span> <span class="library">(ph)</span></li>
<li>
  <span class="spec-name cat-core">Chiller</span> <span class="library">(ph)</span>
  <ul>
    <li>
  <span class="spec-name cat-upstream">AirCooledChiller</span> <span class="library">(hpbs)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsAirCooledChiller</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li><span class="spec-name cat-hpbs">HpbsCentrifugalChiller</span> <span class="library">(hpbs)</span></li>
<li><span class="spec-name cat-hpbs">HpbsChiller</span> <span class="library">(hpbs)</span></li>
<li><span class="spec-name cat-hpbs">HpbsScrewChiller</span> <span class="library">(hpbs)</span></li>
<li>
  <span class="spec-name cat-upstream">WaterCooledChiller</span> <span class="library">(hpbs)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsWaterCooledChiller</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
  </ul>
</li>
<li><span class="spec-name cat-core">Circuit</span> <span class="library">(ph)</span></li>
<li>
  <span class="spec-name cat-core">Conduit</span> <span class="library">(ph)</span> <span class="abstract">[abstract]</span>
  <ul>
    <li>
  <span class="spec-name cat-core">Duct</span> <span class="library">(ph)</span>
  <ul>
    <li>
  <span class="spec-name cat-core">DischargeDuct</span> <span class="library">(ph.equips)</span>
  <ul>
    <li><span class="spec-name cat-core">ColdDeckDischargeDuct</span> <span class="library">(ph.equips)</span></li>
<li><span class="spec-name cat-core">HotDeckDischargeDuct</span> <span class="library">(ph.equips)</span></li>
<li><span class="spec-name cat-core">NeutralDeckDischargeDuct</span> <span class="library">(ph.equips)</span></li>
  </ul>
</li>
<li><span class="spec-name cat-core">EconomizerDuct</span> <span class="library">(ph.equips)</span></li>
<li><span class="spec-name cat-core">ExhaustDuct</span> <span class="library">(ph.equips)</span></li>
<li><span class="spec-name cat-core">FlueDuct</span> <span class="library">(ph.equips)</span></li>
<li><span class="spec-name cat-core">InletDuct</span> <span class="library">(ph.equips)</span></li>
<li><span class="spec-name cat-core">OutsideDuct</span> <span class="library">(ph.equips)</span></li>
<li><span class="spec-name cat-core">ReturnDuct</span> <span class="library">(ph.equips)</span></li>
<li><span class="spec-name cat-core">VentilationDuct</span> <span class="library">(ph.equips)</span></li>
  </ul>
</li>
<li><span class="spec-name cat-core">Pipe</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-core">Wire</span> <span class="library">(ph)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-core">CoolingTower</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsClosedCoolingTower</span> <span class="library">(hpbs)</span></li>
<li><span class="spec-name cat-hpbs">HpbsCoolingTower</span> <span class="library">(hpbs)</span></li>
<li><span class="spec-name cat-hpbs">HpbsOpenCoolingTower</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-upstream">Crah</span> <span class="library">(hpbs)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsCrah</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-core">EvseEquip</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-core">EvseCable</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-core">EvseDispenser</span> <span class="library">(ph)</span></li>
<li>
  <span class="spec-name cat-core">EvsePort</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-core">AcEvsePort</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-core">DcEvsePort</span> <span class="library">(ph)</span></li>
  </ul>
</li>
<li><span class="spec-name cat-core">EvsePowerConverter</span> <span class="library">(ph)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-upstream">Fan</span> <span class="library">(hpbs)</span>
  <ul>
    <li>
  <span class="spec-name cat-upstream">ExhaustFan</span> <span class="library">(hpbs)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsExhaustFan</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
  </ul>
</li>
<li><span class="spec-name cat-core">FlowInverter</span> <span class="library">(ph)</span></li>
<li>
  <span class="spec-name cat-core">FumeHood</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsFumeHood</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-upstream">GasMeter</span> <span class="library">(hpbs)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsGasMeter</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-core">HeatExchanger</span> <span class="library">(ph)</span>
  <ul>
    <li>
  <span class="spec-name cat-core">Coil</span> <span class="library">(ph)</span> <span class="abstract">[abstract]</span>
  <ul>
    <li><span class="spec-name cat-core">CoolingCoil</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-core">HeatingCoil</span> <span class="library">(ph)</span></li>
  </ul>
</li>
<li><span class="spec-name cat-hpbs">HpbsHeatExchanger</span> <span class="library">(hpbs)</span></li>
<li><span class="spec-name cat-hpbs">HpbsPlateHeatExchanger</span> <span class="library">(hpbs)</span></li>
<li><span class="spec-name cat-hpbs">HpbsShellTubeHeatExchanger</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-upstream">HeatPump</span> <span class="library">(hpbs)</span>
  <ul>
    <li>
  <span class="spec-name cat-upstream">AirSourceHeatPump</span> <span class="library">(hpbs)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsAirSourceHeatPump</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-upstream">GroundSourceHeatPump</span> <span class="library">(hpbs)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsGroundSourceHeatPump</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li><span class="spec-name cat-hpbs">HpbsHeatPump</span> <span class="library">(hpbs)</span></li>
<li>
  <span class="spec-name cat-upstream">WaterSourceHeatPump</span> <span class="library">(hpbs)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsWaterSourceHeatPump</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
  </ul>
</li>
<li><span class="spec-name cat-core">HumidifierEquip</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-core">Luminaire</span> <span class="library">(ph)</span></li>
<li>
  <span class="spec-name cat-core">Meter</span> <span class="library">(ph)</span>
  <ul>
    <li>
  <span class="spec-name cat-core">ElecMeter</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-core">AcElecMeter</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-core">DcElecMeter</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-hpbs">HpbsElecMeter</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-core">FlowMeter</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-core">NaturalGasMeter</span> <span class="library">(ph.equips)</span></li>
<li>
  <span class="spec-name cat-core">WaterMeter</span> <span class="library">(ph.equips)</span>
  <ul>
    <li><span class="spec-name cat-core">DomesticWaterMeter</span> <span class="library">(ph.equips)</span></li>
<li><span class="spec-name cat-hpbs">HpbsWaterMeter</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
  </ul>
</li>
  </ul>
</li>
<li>
  <span class="spec-name cat-core">Motor</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-core">FanMotor</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-core">PumpMotor</span> <span class="library">(ph)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-core">Panel</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-core">ControlsPanel</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-core">ElecPanel</span> <span class="library">(ph)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-core">Plant</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-core">ChilledWaterPlant</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-core">HotWaterPlant</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-core">SteamPlant</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-core">VrfRefrigPlant</span> <span class="library">(ph)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-upstream">Pump</span> <span class="library">(hpbs)</span>
  <ul>
    <li>
  <span class="spec-name cat-upstream">ChilledWaterPump</span> <span class="library">(hpbs)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsChilledWaterPump</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-upstream">CondenserWaterPump</span> <span class="library">(hpbs)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsCondenserWaterPump</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-upstream">HotWaterPump</span> <span class="library">(hpbs)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsHotWaterPump</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
  </ul>
</li>
<li><span class="spec-name cat-core">Rack</span> <span class="library">(ph)</span></li>
<li>
  <span class="spec-name cat-core">RadiantEquip</span> <span class="library">(ph)</span> <span class="abstract">[abstract]</span>
  <ul>
    <li><span class="spec-name cat-core">ChilledBeam</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-hpbs">HpbsRadiantFloor</span> <span class="library">(hpbs)</span></li>
<li><span class="spec-name cat-hpbs">HpbsRadiantPanel</span> <span class="library">(hpbs)</span></li>
<li><span class="spec-name cat-core">RadiantFloor</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-core">Radiator</span> <span class="library">(ph)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-upstream">SteamMeter</span> <span class="library">(hpbs)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsSteamMeter</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li><span class="spec-name cat-core">Tank</span> <span class="library">(ph)</span></li>
<li>
  <span class="spec-name cat-upstream">ThermalMeter</span> <span class="library">(hpbs)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsBtuMeter</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li><span class="spec-name cat-core">Thermostat</span> <span class="library">(ph)</span></li>
<li>
  <span class="spec-name cat-upstream">UnitHeater</span> <span class="library">(hpbs)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsUnitHeater</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li><span class="spec-name cat-core">Ups</span> <span class="library">(ph)</span></li>
<li>
  <span class="spec-name cat-core">VerticalTransport</span> <span class="library">(ph)</span> <span class="abstract">[abstract]</span>
  <ul>
    <li><span class="spec-name cat-core">Elevator</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-core">Escalator</span> <span class="library">(ph)</span></li>
<li><span class="spec-name cat-core">MovingWalkway</span> <span class="library">(ph)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-core">VrfEquip</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-core">BranchSelector</span> <span class="library">(ph)</span></li>
<li>
  <span class="spec-name cat-core">VrfIndoorUnit</span> <span class="library">(ph)</span>
  <ul>
    <li><span class="spec-name cat-core">VrfIndoorUnitFcu</span> <span class="library">(ph)</span></li>
  </ul>
</li>
<li><span class="spec-name cat-core">VrfOutdoorUnit</span> <span class="library">(ph)</span></li>
  </ul>
</li>
<li>
  <span class="spec-name cat-upstream">WaterHeater</span> <span class="library">(hpbs)</span>
  <ul>
    <li><span class="spec-name cat-hpbs">HpbsTanklessWaterHeater</span> <span class="library">(hpbs)</span></li>
<li><span class="spec-name cat-hpbs">HpbsWaterHeater</span> <span class="library">(hpbs)</span></li>
  </ul>
</li>
<li><span class="spec-name cat-core">Well</span> <span class="library">(ph)</span></li>
  </ul>
</li>
        </ul>
    </div>

    <script>
        // Make tree collapsible
        document.querySelectorAll('.tree li').forEach(li => {
            if (li.querySelector('ul')) {
                li.classList.add('has-children');
                li.querySelector('.spec-name').addEventListener('click', () => {
                    li.classList.toggle('collapsed');
                });
            }
        });

        // Search functionality
        document.getElementById('search').addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            document.querySelectorAll('.tree .spec-name').forEach(el => {
                el.classList.remove('highlight');
                if (query && el.textContent.toLowerCase().includes(query)) {
                    el.classList.add('highlight');
                    // Expand parents
                    let parent = el.closest('li');
                    while (parent) {
                        parent.classList.remove('collapsed');
                        parent = parent.parentElement.closest('li');
                    }
                }
            });
        });

        // Filter by category
        function updateFilters() {
            const showCore = document.getElementById('show-core').checked;
            const showUpstream = document.getElementById('show-upstream').checked;
            const showHpbs = document.getElementById('show-hpbs').checked;

            document.querySelectorAll('.tree li').forEach(li => {
                const specName = li.querySelector(':scope > .spec-name');
                if (!specName) return;

                let show = true;
                if (specName.classList.contains('cat-core') && !showCore) show = false;
                if (specName.classList.contains('cat-upstream') && !showUpstream) show = false;
                if (specName.classList.contains('cat-hpbs') && !showHpbs) show = false;

                li.style.display = show ? '' : 'none';
            });
        }

        document.getElementById('show-core').addEventListener('change', updateFilters);
        document.getElementById('show-upstream').addEventListener('change', updateFilters);
        document.getElementById('show-hpbs').addEventListener('change', updateFilters);

        function expandAll() {
            document.querySelectorAll('.tree li.collapsed').forEach(li => {
                li.classList.remove('collapsed');
            });
        }

        function collapseAll() {
            document.querySelectorAll('.tree li.has-children').forEach(li => {
                li.classList.add('collapsed');
            });
        }

        // Start with top-level expanded, rest collapsed
        document.querySelectorAll('.tree > ul > li > ul li.has-children').forEach(li => {
            li.classList.add('collapsed');
        });
    </script>
</body>
</html>